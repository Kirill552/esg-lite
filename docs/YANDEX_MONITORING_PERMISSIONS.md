# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π Service Account —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

## üìã –¢—Ä–µ–±—É–µ–º—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –¥–ª—è Yandex Cloud Monitoring

–î–ª—è —Ä–∞–±–æ—Ç—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Yandex Cloud Monitoring –≤–∞—à–µ–º—É Service Account –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã —Å–ª–µ–¥—É—é—â–∏–µ —Ä–æ–ª–∏:

### üîë –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ä–æ–ª–∏:
- **`monitoring.editor`** - –¥–ª—è –∑–∞–ø–∏—Å–∏ –º–µ—Ç—Ä–∏–∫
- **`iam.serviceAccounts.user`** - –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–æ–∫–µ–Ω–∞–º–∏

### üìä –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–æ–ª–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
- **`monitoring.viewer`** - –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–∞—à–±–æ—Ä–¥–æ–≤
- **`monitoring.admin`** - –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–ª–µ—Ä—Ç–∞–º–∏

## üåê –ü–æ—à–∞–≥–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

### –®–∞–≥ 1: –û—Ç–∫—Ä–æ–π—Ç–µ Yandex Cloud Console
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://console.cloud.yandex.ru
2. –í–æ–π–¥–∏—Ç–µ –≤ —Å–≤–æ–π –∞–∫–∫–∞—É–Ω—Ç
3. –í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—É—é –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é –∏ –æ–±–ª–∞–∫–æ

### –®–∞–≥ 2: –ù–∞–π–¥–∏—Ç–µ —Å–≤–æ–π Service Account
1. –í –ª–µ–≤–æ–º –º–µ–Ω—é –≤—ã–±–µ—Ä–∏—Ç–µ **"–°–µ—Ä–≤–∏—Å–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã"** (Service Accounts)
2. –ù–∞–π–¥–∏—Ç–µ Service Account, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–≥–æ —É –≤–∞—Å –µ—Å—Ç—å –∫–ª—é—á –≤ —Ñ–∞–π–ª–µ `authorized_key.json`
3. –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –µ–≥–æ –∏–º—è –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º

### –®–∞–≥ 3: –ù–∞–∑–Ω–∞—á—å—Ç–µ —Ä–æ–ª–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–∞—Ç–∞–ª–æ–≥–∞
1. –í –∫–∞—Ä—Ç–æ—á–∫–µ Service Account –Ω–∞–∂–º–∏—Ç–µ **"–ù–∞–∑–Ω–∞—á–∏—Ç—å —Ä–æ–ª–∏"**
2. –í—ã–±–µ—Ä–∏—Ç–µ **"–ù–∞ –∫–∞—Ç–∞–ª–æ–≥"** (For folder)
3. –î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ —Ä–æ–ª–∏:

#### üîß –†–æ–ª—å monitoring.editor:
```
–†–æ–ª—å: monitoring.editor
–†–µ—Å—É—Ä—Å: –ö–∞—Ç–∞–ª–æ–≥ (–≤–∞—à FOLDER_ID)
–û–ø–∏—Å–∞–Ω–∏–µ: –ü–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –≤ Yandex Monitoring
```

#### üîß –†–æ–ª—å iam.serviceAccounts.user:
```
–†–æ–ª—å: iam.serviceAccounts.user  
–†–µ—Å—É—Ä—Å: –ö–∞—Ç–∞–ª–æ–≥ (–≤–∞—à FOLDER_ID)
–û–ø–∏—Å–∞–Ω–∏–µ: –ü–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Service Account –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è IAM —Ç–æ–∫–µ–Ω–æ–≤
```

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–µ–∫—É—â–∏–µ —Ä–æ–ª–∏
–ü–æ—Å–ª–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è —Ä–æ–ª–µ–π —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ —Ä–∞–∑–¥–µ–ª–µ **"–†–æ–ª–∏"** –≤–∞—à–µ–≥–æ Service Account –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è:
- ‚úÖ `monitoring.editor`
- ‚úÖ `iam.serviceAccounts.user`

## üîç –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± —á–µ—Ä–µ–∑ IAM

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ IAM, –º–æ–∂–µ—Ç–µ –Ω–∞–∑–Ω–∞—á–∏—Ç—å —Ä–æ–ª–∏ —á–µ—Ä–µ–∑ —Ä–∞–∑–¥–µ–ª IAM:

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **"IAM"** ‚Üí **"–ù–∞–∑–Ω–∞—á–∏—Ç—å —Ä–æ–ª–∏"**
2. –í—ã–±–µ—Ä–∏—Ç–µ **"–°–µ—Ä–≤–∏—Å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç"** –∫–∞–∫ —Å—É–±—ä–µ–∫—Ç
3. –ù–∞–π–¥–∏—Ç–µ –≤–∞—à Service Account
4. –ù–∞–∑–Ω–∞—á—å—Ç–µ –Ω—É–∂–Ω—ã–µ —Ä–æ–ª–∏ –Ω–∞ –∫–∞—Ç–∞–ª–æ–≥

## üìÅ –ü—Ä–æ–≤–µ—Ä–∫–∞ FOLDER_ID

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ `.env` —É–∫–∞–∑–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π FOLDER_ID:

1. –í Yandex Cloud Console –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –Ω—É–∂–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥
2. –í –≤–µ—Ä—Ö–Ω–µ–π —á–∞—Å—Ç–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ ID –∫–∞—Ç–∞–ª–æ–≥–∞
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –æ–Ω —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å `YANDEX_CLOUD_FOLDER_ID` –≤ `.env`

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é:

```bash
npm run test:yandex-monitoring
```

–ï—Å–ª–∏ —Ç–µ—Å—Ç –ø—Ä–æ—à–µ–ª —É—Å–ø–µ—à–Ω–æ, –≤—ã —É–≤–∏–¥–∏—Ç–µ:
```
‚úÖ –¢–µ—Å—Ç–æ–≤–∞—è –º–µ—Ç—Ä–∏–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞
‚úÖ –°–∏—Å—Ç–µ–º–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã  
‚úÖ PostgreSQL –º–µ—Ç—Ä–∏–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã
‚úÖ –ú–∞—Å—Å–æ–≤–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –º–µ—Ç—Ä–∏–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞
üéâ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!
```

## üîß –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞ 403 Forbidden
```
‚ùå –£ Service Account –Ω–µ—Ç –ø—Ä–∞–≤ –Ω–∞ –∑–∞–ø–∏—Å—å –º–µ—Ç—Ä–∏–∫
üîß –†–µ—à–µ–Ω–∏–µ: –ù–∞–∑–Ω–∞—á—å—Ç–µ —Ä–æ–ª—å monitoring.editor
```

### –û—à–∏–±–∫–∞ 401 Unauthorized  
```
‚ùå –ü—Ä–æ–±–ª–µ–º—ã —Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π IAM —Ç–æ–∫–µ–Ω–∞
üîß –†–µ—à–µ–Ω–∏–µ: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–æ–ª—å iam.serviceAccounts.user
```

### –û—à–∏–±–∫–∞ "Invalid folder ID"
```
‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π FOLDER_ID
üîß –†–µ—à–µ–Ω–∏–µ: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ YANDEX_CLOUD_FOLDER_ID –≤ .env
```

## üìä –ü—Ä–æ—Å–º–æ—Ç—Ä –º–µ—Ç—Ä–∏–∫

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–µ—Ç—Ä–∏–∫–∏ –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –≤:
https://console.cloud.yandex.ru/folders/YOUR_FOLDER_ID/monitoring

### üîç –ü–æ–∏—Å–∫ –º–µ—Ç—Ä–∏–∫:
- `esg_lite_*` - –º–µ—Ç—Ä–∏–∫–∏ —Å–∏—Å—Ç–µ–º—ã ESG Lite
- `postgresql_*` - –º–µ—Ç—Ä–∏–∫–∏ PostgreSQL
- `queue_*` - –º–µ—Ç—Ä–∏–∫–∏ –æ—á–µ—Ä–µ–¥–µ–π pg-boss

## ‚è∞ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –º–µ—Ç—Ä–∏–∫–∏ –±—É–¥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- **–°–∏—Å—Ç–µ–º–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏**: –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
- **PostgreSQL –º–µ—Ç—Ä–∏–∫–∏**: –∫–∞–∂–¥—ã–µ 10 –º–∏–Ω—É—Ç
- **–ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö**: –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π
